---
title: "Reverse Engineering Project"
author: "James Hartner, Daniel Lawall, Daniel Philipose"
date: "10/5/2021"
output:
  html_document:
    theme: cerulean
    highlight: pygments
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
install.packages('lubridate')
```

## Introduction 

In this notebook, we are reverse engineering the story, ["Nearly 250 women have been fatally shot by police since 2015"](https://www.washingtonpost.com/graphics/2020/investigations/police-shootings-women/)

This story is from the Washington Post and was written by Marisa Iati, Jennifer Jenkins and Sommer Brugal
## Load libraries

Loading required libraries for this analysis.

```{r echo=FALSE, message=FALSE}
options(scipen=999)
library(tidyverse)
library(janitor)
library(lubridate)
```

## Load and Cleaning Data

In this section, describe the source of the data, write a basic data dictionary for data you are working with, and discuss any caveats or issues you discovered working with this data. 

```{r}
# Load required data

# Path to data should be loaded from folder "data" i.e. read_csv("data/name_of_data.csv")
Washington_Post_data<-read_csv("data/fatal-police-shootings-data.csv")
Washington_Post_data_update_oct_10 <- read_csv("data/update(oct10).csv")
# Clean required data and prepare for analysis if needed. 


```

## Sentences to Engineer
In this notebook, we are reverse engineering five sentences from the story.

### Sentence 1

* **Sentence text**: [Paste in sentence to engineer here]
"About 31 percent, or 77, of the 247 women fatally shot by police since 2015 had mental health issues, compared to 22 percent of the 5,362 men killed."

* **Analysis summary**: [Write up two to three sentences describing the results of your analysis.  Were you able to confirm the finding? If not, why not?]


Our findings were a little different because the story was posted over a year ago (Sept. 4, 2020) and the Washington Post have keep updating the data. In the data, which was taken Sept. 28, 2020, we found that since 2015, the percentage of women fatally shot by police who had mental health issues was higher at roughly 32 percent (95 of the 293 women). Men who had mental health issues was around 22 percent still ( 1398 of the 6303 men killed).



```{r}

# Put code to reverse engineer sentence here
#Data from Sept.28
women_fatally_shot<- Washington_Post_data %>%
filter(gender=="F")
women_fatally_shot %>%
group_by(signs_of_mental_illness) %>%
summarize(
total=n(),
percentage=total/293
) %>%
arrange(desc(total))


#Men percentage
men_fatally_shot<-Washington_Post_data %>%
filter(gender=="M")
men_fatally_shot %>%
group_by(signs_of_mental_illness) %>%
summarize(
 count=n(),
 percentage=count/6298
) %>%
arrange(desc(count))

# What Prof. Mussenden did 
Mental_illness <- Washington_Post_data %>%
group_by(gender, signs_of_mental_illness) %>%
summarise(
   total=n()
) %>%
mutate(percentage=total/sum(total)) %>%
arrange(desc(total))


```

Updated data OCT.10 found relatively similar numbers. However, in less than a two week span, there were five men and one woman who were fatally shot by Police, according to the additional data points added.


# Display results of code below this codeblock

### Sentence 2

* **Sentence text**: [Paste in sentence to engineer here]
"Since 2015, Black women have accounted for less than 1 percent of the overall fatal shootings in cases where race was known. But within this small subset, Black women, who are 13 percent of the female population, account for 20 percent of the women shot and killed and 28 percent of the unarmed deaths."
* **Analysis summary**: [Write up two to three sentences describing the results of your analysis.  Were you able to confirm the finding? If not, why not?]

We broke this statement into three parts in order to determine each of the listed  facts. The process was similar across all three parts, in which we either filtered or grouped by race and gender. In each part, we also used "mutate" to create a new column to determien the percentages. We were able to confirm all three of the facts in this statement: Black women account for less than 1% of fatal shootings where race is know, 20% of the women shot and 28% of the total number of unarmed deaths.

```{r}
# Put code to reverse engineer sentence here

# Display results of code below this codeblock
overall_black_women <- Washington_Post_data %>%
  group_by(race, gender) %>%
   summarise(
    count=n()
  ) %>%
  mutate(pct=(count/5841)*100)
  

Black_women <- Washington_Post_data %>%
  filter(gender == "F") %>%
  group_by(race) %>%
  summarise(
    count=n()
  ) %>%
  mutate(pct_by_race=count/sum(count))

Unarmed_black_women <- Washington_Post_data %>%
  filter(gender == "F") %>%
  filter(armed == "unarmed") %>%
  group_by(race) %>%
  summarise(
    count=n()
  ) %>%
  mutate(total_unarmed = sum(count)) %>%
  mutate(pct_by_race=count/total_unarmed)


```

### Sentence 3

* **Sentence text**: [Paste in sentence to engineer here]
"The average age of women and men killed by police was 37, and about one-third were 25 to 34."
* **Analysis summary**: [Write up two to three sentences describing the results of your analysis.  Were you able to confirm the finding? If not, why not?]


```{r}
#Average for women
WaPo_data<- Washington_Post_data
women_fatally_shot <- WaPo_data %>%
  filter(gender=="F")

age_women_fatally_shot <- women_fatally_shot %>%
  drop_na() %>%
  summarise(
    mean_age = mean(age)
  )

# Average for men
men_fatally_shot <- WaPo_data %>%
  filter(gender=="M")

age_men_fatally_shot <- men_fatally_shot %>%
   drop_na() %>%
  summarise(
    mean_age = mean(age)
  )


#one-third 25 to 34
WaPo_data %>%
  filter(age >= "25" & age <= "34") %>%
  summarise(
    spec_count = n()
  ) %>%
mutate(pct=(spec_count/6594)*100)

WaPo_data %>%
  summarise(
    total_count = n()
  ) 

  
# Display results of code below this codeblock
glimpse(age_men_fatally_shot)
glimpse(age_women_fatally_shot)


# Display results of code below this codeblock

```

### Sentence 4
* **Sentence text**: [Paste in sentence to engineer here]
"The starkest difference between women and men is the rate: Women account for about half the population, but 4 percent of the killings. Of those fatally shot every year, about 44 have been women."
* **Analysis summary**: [Write up two to three sentences describing the results of your analysis.  Were you able to confirm the finding? If not, why not?]
This roughly followed the same findings as Washington Post. We found that it was roughly 4% of the population killed were women from the police shootings. We also saw that if you take the average amount of women shot per year starting from 1-1-2015 (the first year the data started) to the last data point  (9/25/2021), it roughly equates to 44 women shot per year. If we took the average from the start of the first data date taken (1-2-2015) to the last, we would still see basically the same results. 
```{r}

#Ask Sean on if we should filter every year then take the average of the women dead or not for the 44 women every year
# Put code to reverse engineer sentence here
Question_3 <-Washington_Post_data %>%
filter(gender=="F")

#women_fatally_shot %>%
 # filter(gender=="F") %>%
  #summarise(
   #count = n()
  #) %>%
#mutate(pct=(count/5))
#Percentage of killings for women compared to men
women_fatally_shot %>%
  summarise(
   women_shot = n() #Here, we are counting how many women have been fatally shot by police. 
  ) %>%
  mutate(pct=(women_shot/nrow(Washington_Post_data))) #Here, we're are calculating the percentage of women shot from the whole data. 

years<-Washington_Post_data %>%
  mutate(
    CleanDate = as.POSIXct(date, format="%Y-%m-%d %H:%M:%S")
) #This converts the dates into a manageable format (founded in the class textbook). This will allow us to group the years and summarize the killings from each year as shown in the code below. 
  years %>%
  mutate(date = floor_date(date, "year")) %>% # We are creating a variable that groups the dates from their respective years, so, for example, everything from 2015 we'll all be summarized together. 
  filter(gender=="F") %>% #For this question, we want to see how many women were killed by police each year then take the average to see if it matches with what the Washington Post stated. 
  group_by(date) %>%
  summarise(
    total = n())%>%
  arrange(desc(total))
  years %>% #This will take the average 
  filter(gender=="F") %>%
  summarise(
    count=n(),
    average=count/7,#2015-2021 is considered seven years, since we are going from 01-01-2015 to 12-31-2021. 
   average_from_last_data_point =count/6.7315 #Note-2021 is not over, so technically, we should be dividing by the last datapoint registered as 9/25/2021/ so 6 years and 267 days which would be 6.7315 years. 
  )
```


### Sentence 5

* **Sentence text**: [Paste in sentence to engineer here]
* **Analysis summary**: [Write up two to three sentences describing the results of your analysis.  Were you able to confirm the finding? If not, why not?]

```{r}
# Put code to reverse engineer sentence here
#We only had four sentences, since sentence 2 had two of the main points combined.
# Display results of code below this codeblock

```

-30-